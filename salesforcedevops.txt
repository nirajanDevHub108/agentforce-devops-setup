1ï¸âƒ£ Scratch Org Lifecycle

Scratch orgs are temporary, source-driven orgs used for development and testing.

ğŸ”¹ Create a Scratch Org
sf org create scratch \
  -f config/project-scratch-def.json \
  -a myScratch \
  -d \
  -y 7


Explanation

-f â†’ scratch org definition file

-a â†’ alias for easy reference

-d â†’ set as default org

-y â†’ lifespan in days

ğŸ”¹ List All Orgs
sf org list


Shows all authenticated orgs (scratch, sandbox, prod).

ğŸ”¹ Open Scratch Org in Browser
sf org open -o myScratch

ğŸ”¹ Delete Scratch Org
sf org delete scratch -o myScratch


Deletes the org when work is done.

2ï¸âƒ£ Source Tracking & Syncing (Scratch Orgs)

Used to keep local source and org metadata in sync.

ğŸ”¹ Push Local Source â†’ Scratch Org
sf project deploy start -o myScratch


Deploys local code to the org.

ğŸ”¹ Pull Org Changes â†’ Local
sf project retrieve start -o myScratch


Retrieves changes made directly in the org.

ğŸ”¹ Preview Changes (No Action)
sf project deploy preview -o myScratch
sf project retrieve preview -o myScratch


Shows what will change before deploy/retrieve.

ğŸ”¹ Reset Source Tracking (Last Resort)
sf project reset tracking -o myScratch


âš ï¸ Clears tracking history only (does NOT delete code).

3ï¸âƒ£ Apex: Create, Run, Test
ğŸ”¹ Create Apex Class
sf apex generate class \
  -n MyClass \
  -d force-app/main/default/classes

ğŸ”¹ Create Apex Trigger
sf apex generate trigger \
  -n MyTrigger \
  -s Account \
  -e "before insert,before update" \
  -d force-app/main/default/triggers

ğŸ”¹ Run Anonymous Apex

From file:

sf apex run -f scripts/apex/hello.apex -o myScratch


Inline:

echo "System.debug('Hello');" | sf apex run -o myScratch

4ï¸âƒ£ Apex Tests & Code Coverage
ğŸ”¹ Run All Local Tests
sf apex test run \
  -l RunLocalTests \
  -o myScratch \
  --wait 20 \
  --result-format human \
  --code-coverage

ğŸ”¹ Run Specific Test Classes
sf apex test run \
  -n AccountRatingUpdaterTest,TestApexClassTest \
  -o myScratch \
  --wait 20 \
  --code-coverage

ğŸ”¹ Get Test Results by Run ID
sf apex test report \
  -i 707XXXXXXXXXXXX \
  -o myScratch \
  --result-format human

ğŸ”¹ Retrieve Code Coverage (JSON)
sf apex test report \
  -i 707XXXXXXXXXXXX \
  -o myScratch \
  --code-coverage \
  --result-format json | jq '.result.coverage'

5ï¸âƒ£ Metadata Deploy & Retrieve (Non-Tracked Orgs)

Used mainly for sandboxes & production.

ğŸ”¹ Deploy Entire Source Folder
sf project deploy start -o myScratch -d force-app

ğŸ”¹ Deploy Using Manifest
sf project deploy start -o myScratch -x manifest/package.xml

ğŸ”¹ Preview Deploy
sf project deploy preview -o myScratch -x manifest/package.xml

ğŸ”¹ Retrieve Using Manifest
sf project retrieve start -o myScratch -x manifest/package.xml

ğŸ”¹ Deploy with Test Level
sf project deploy start \
  -o myScratch \
  -d force-app \
  --test-level RunLocalTests

6ï¸âƒ£ Keeping Scratch Org and Source Equal
ğŸ”¹ Make Local = Org
sf project retrieve start -o myScratch

ğŸ”¹ Make Org = Local
sf project deploy start -o myScratch

ğŸ”¹ Best Practice Loop

Pull before coding

Deploy after coding

Preview if diverged

Reset tracking only if stuck

7ï¸âƒ£ Org Login & Authentication
ğŸ”¹ Login via Browser
sf org login web -a myAlias

ğŸ”¹ Login via JWT (CI/CD)
sf org login jwt \
  -u user@example.com \
  -i clientId \
  -f server.key \
  -r https://login.salesforce.com \
  -a myAlias

ğŸ”¹ Get SFDX Auth URL
sf org display --verbose -o myAlias --json | jq -r '.result.sfdxAuthUrl'


âš ï¸ Treat as a secret.

ğŸ”¹ Login Using Auth URL
sf org login sfdx-url -a myAlias -f authurl.txt

8ï¸âƒ£ Data Operations
ğŸ”¹ Run SOQL Query
sf data query \
  -q "SELECT Id, Name, Rating FROM Account LIMIT 10" \
  -o myScratch

ğŸ”¹ Import Data
sf data import tree -o myScratch -p data/plan.json

ğŸ”¹ Export Data
sf data export tree \
  -o myScratch \
  -q "SELECT Id, Name FROM Account LIMIT 5" \
  -d data -p

9ï¸âƒ£ LWC, PermSets, UI
ğŸ”¹ Create Lightning Web Component
sf lightning generate component \
  -n myLwc \
  -d force-app/main/default/lwc

ğŸ”¹ Assign Permission Set
sf org assign permset -n CustomerTierAccess -o myScratch

ğŸ”¹ Open App or Page
sf org open -o myScratch -p /lightning/n/My_App

ğŸ”Ÿ Packaging (Unlocked Packages)
ğŸ”¹ Create Package
sf package create -n MyPkg -t Unlocked -r force-app

ğŸ”¹ Create Package Version
sf package version create -p MyPkg -x -w 30 -c

ğŸ”¹ Install Package
sf package install -p 04tXXXXXXXXXXXX -o myScratch -w 30

ğŸ” Security & Best Practices (VERY IMPORTANT)

âŒ Never commit auth URLs or keys

âœ… Use Dev Hub for scratch orgs

âœ… Use aliases consistently

âœ… Run RunLocalTests before merge

âœ… Prefer source tracking for scratch orgs

âœ… Manifest-based deploys for prod